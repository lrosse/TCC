{% extends "loja/barra_lateral.html" %}
{% block title %}Gest칚o Financeira{% endblock %}

{% block content %}
<div class="container-fluid px-4">
  <h2 class="fw-semibold mb-4">Gest칚o Financeira</h2>

  <!-- Abas de navega칞칚o -->
  <ul class="nav nav-tabs mb-4" id="financeiroTabs" role="tablist">
    <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#resumo">Resumo Geral</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#produtos">Produtos</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#pedidos">Pedidos</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#despesas">Despesas</button></li>
  </ul>

  <div class="tab-content">

    <!-- 游댳 RESUMO GERAL -->
    <div class="tab-pane fade show active" id="resumo">
      <div class="row g-4 mb-4">
        <!-- Cards -->
        <div class="col-md-3">
          <div class="card text-center shadow-sm border-0">
            <div class="card-body">
              <h6 class="text-muted">Receita Total</h6>
              <p class="fs-4 fw-bold text-success">R$ <!-- FUTURO: total_receitas --></p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center shadow-sm border-0">
            <div class="card-body">
              <h6 class="text-muted">Custo Total</h6>
              <p class="fs-4 fw-bold text-danger">R$ <!-- FUTURO: custo_total --></p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center shadow-sm border-0">
            <div class="card-body">
              <h6 class="text-muted">Despesas Fixas</h6>
              <p class="fs-4 fw-bold text-warning">R$ <!-- FUTURO: despesas_fixas --></p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center shadow-sm border-0">
            <div class="card-body">
              <h6 class="text-muted">Lucro L칤quido</h6>
              <p class="fs-4 fw-bold text-primary">R$ <!-- FUTURO: lucro_liquido --></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Gr치ficos -->
      <div class="row g-4 mb-4">
        <div class="col-md-6">
          <div class="card shadow-sm border-0">
            <div class="card-body">
              <h6 class="fw-semibold mb-3">Receitas vs Despesas (Mensal)</h6>
              <canvas id="graficoReceitasDespesas"></canvas>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card shadow-sm border-0">
            <div class="card-body">
              <h6 class="fw-semibold mb-3">Lucro L칤quido (Acumulado)</h6>
              <canvas id="graficoLucro"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 游댳 PRODUTOS -->
    <div class="tab-pane fade" id="produtos">
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <h5 class="fw-semibold mb-3">Margens de Produtos</h5>
          <table class="table table-striped align-middle">
            <thead>
              <tr>
                <th>Produto</th>
                <th>Custo</th>
                <th>Pre칞o Venda</th>
                <th>Margem (%)</th>
                <th>Lucro Unit치rio</th>
              </tr>
            </thead>
            <tbody>
              <!-- FUTURO: loop sobre produtos -->
              <tr>
                <td>Exemplo Produto</td>
                <td>R$ 50,00</td>
                <td>R$ 80,00</td>
                <td>60%</td>
                <td>R$ 30,00</td>
              </tr>
              <!-- /FUTURO -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- 游댳 PEDIDOS -->
    <div class="tab-pane fade" id="pedidos">
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <h5 class="fw-semibold mb-3">Lucro por Pedido</h5>
          <table class="table table-striped align-middle">
            <thead>
              <tr>
                <th>N췈 Pedido</th>
                <th>Cliente</th>
                <th>Data</th>
                <th>Receita</th>
                <th>Custo</th>
                <th>Lucro</th>
              </tr>
            </thead>
            <tbody>
              <!-- FUTURO: loop sobre pedidos pagos -->
              <tr>
                <td>#202509-AB12CD34</td>
                <td>Cliente Exemplo</td>
                <td>08/09/2025</td>
                <td>R$ 500,00</td>
                <td>R$ 300,00</td>
                <td class="text-success">R$ 200,00</td>
              </tr>
              <!-- /FUTURO -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- 游댳 DESPESAS -->
    <div class="tab-pane fade" id="despesas">
      <div class="row g-4 mb-4">
        <div class="col-md-6">
          <div class="card shadow-sm border-0">
            <div class="card-body">
              <h5 class="fw-semibold mb-3">Adicionar Despesa</h5>
              <form>
                <!-- FUTURO: POST para adicionar_lancamento -->
                <div class="mb-3">
                  <label class="form-label">Categoria</label>
                  <input type="text" class="form-control" placeholder="Ex: Marketing, Aluguel">
                </div>
                <div class="mb-3">
                  <label class="form-label">Valor (R$)</label>
                  <input type="number" step="0.01" class="form-control">
                </div>
                <div class="mb-3">
                  <label class="form-label">Data</label>
                  <input type="date" class="form-control">
                </div>
                <div class="mb-3">
                  <label class="form-label">Descri칞칚o</label>
                  <textarea class="form-control"></textarea>
                </div>
                <button class="btn btn-danger" type="submit">Adicionar Despesa</button>
              </form>
            </div>
          </div>
        </div>

        <div class="col-md-6">
          <div class="card shadow-sm border-0">
            <div class="card-body">
              <h5 class="fw-semibold mb-3">Despesas Registradas</h5>
              <table class="table table-striped align-middle">
                <thead>
                  <tr>
                    <th>Data</th>
                    <th>Categoria</th>
                    <th>Valor</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- FUTURO: loop sobre despesas -->
                  <tr>
                    <td>01/09/2025</td>
                    <td>Aluguel</td>
                    <td>R$ 1.200,00</td>
                  </tr>
                  <!-- /FUTURO -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div> <!-- tab-content -->
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Gr치fico Receitas vs Despesas
new Chart(document.getElementById('graficoReceitasDespesas'), {
  type: 'bar',
  data: {
    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
    datasets: [
      { label: 'Receitas', data: [1000, 1200, 900, 1400, 2000, 1800], backgroundColor: '#198754' },
      { label: 'Despesas', data: [500, 600, 400, 800, 1000, 950], backgroundColor: '#dc3545' }
    ]
  }
});

// Gr치fico Lucro Acumulado
new Chart(document.getElementById('graficoLucro'), {
  type: 'line',
  data: {
    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
    datasets: [
      { label: 'Lucro L칤quido', data: [500, 600, 500, 600, 1000, 850], borderColor: '#0d6efd', fill: true }
    ]
  }
});
</script>
{% endblock %}
